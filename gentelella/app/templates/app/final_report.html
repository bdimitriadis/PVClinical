{% extends "app/base_site.html" %}
{% load i18n %}
{% load staticfiles %}


{% block title %} Final Report {% endblock title %}

{% block stylesheets %}
{{ block.super }}
<link href="/static/vendors/datatables.net-bs/css/dataTables.bootstrap.min.css" rel="stylesheet">
<link href="/static/vendors/datatables.net-buttons-bs/css/buttons.bootstrap.min.css" rel="stylesheet">
<link href="/static/vendors/datatables.net-fixedheader-bs/css/fixedHeader.bootstrap.min.css" rel="stylesheet">
<link href="/static/vendors/datatables.net-responsive-bs/css/responsive.bootstrap.min.css" rel="stylesheet">
<link href="/static/vendors/datatables.net-scroller-bs/css/scroller.bootstrap.min.css" rel="stylesheet">
<meta name="viewport" content="width=device-width, initial-scale=1">
{% endblock stylesheets %}



{% block content %}

<div class="right_col" role="main">
    <div class="row tile_count">
        <div class="col-4 col-offset-6">
            <div class="x_panel">
                <div class="x_title">
                    <h2>{% trans "My Review" %}</h2>
                    <div class="clearfix"></div>
                </div>

                <div class="x_content">
                    <p class="text-muted font-13 m-b-30">
                        {% trans "Make your own review by following next steps:" %}
                    </p>

                    <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
                        <li class="nav-item">
                          <button type="button" class="btn btn-secondary" data-toggle="collapse" data-target="#step1">Step 1</button>
                                <i class="fas fa-long-arrow-alt-right fa-2x"></i>
                        </li>

                        <li class="nav-item">
                            <button type="button" class="btn btn-secondary" data-toggle="collapse" data-target="#step2" name="checkenable" id="result" disabled>Step 2</button>
                                <i class="fas fa-long-arrow-alt-right fa-2x"></i>
                        </li>
                        <li class="nav-item">
                            <button type="button" class="btn btn-secondary" data-toggle="collapse" data-target="#step3" disabled>Step 3</button>

                        </li>
                        </ul>
                        <div class="tab-content" id="pills-tabContent">
                        <div class="collapse" id="step1" role="tabpanel" aria-labelledby="pills-home-tab">
                           <p> You can choose which of the following  information you want to be in the overall report of this scenario.</p>
                            <p> -If you want all information from one workspace to be a part of your report, press the buttom in the left side of workspace's name.</p>
                           <p> -if you wat to choose witch information of every workspace you want to take part on your report press the buttom in the right side to see in detail what you will include. </p>
                        </div>
                        <div class="collapse" id="step2" role="tabpanel" aria-labelledby="pills-profile-tab">
                            <p>Now you can edit your report and include some additions that you think will be helpfull to complete your review.</p>

                            <p>Click in frames bellow to write your commets, save it or deleted with the buttoms in the right sight of those boxes.</p>
                        </div>
                        <div class="collapse" id="step3" role="tabpanel" aria-labelledby="pills-profile-tab">
                            <p>Choose the type of your file.</p>

                        </div>
                        </div>

                    <div class="container">
                            <h2>Step 1: Choose your options for every workspace</h2>
                            <br>
                            <!-- Nav tabs -->
                            <ul class="nav nav-tabs " role="tablist">
                            <li class="nav-item ">
                              <a class="nav-link active" data-toggle="tab" href="#OHDSI">OHDSI</a>
                            </li>
                            <li class="nav-item">
                              <a class="nav-link" data-toggle="tab" href="#OpenFDA">OpenFDA</a>
                            </li>
                            <li class="nav-item">
                              <a class="nav-link" data-toggle="tab" href="#PubMed">PubMed</a>
                            </li>
                            </ul>

                            <!-- Tab panes -->
                            <div class="tab-content">
                            <div id="OHDSI" class="container tab-pane active"><br>
                                <input type="checkbox"   onclick="enablebutton()">
                              <label for="ohdsi"  > Add every information that I had from OHDSI</label>
                                <br></br>
                                <div class="container">
                                    <div class="panel-group" id="accordion">
                                        <div class="panel panel-default">
                                          <div class="panel-heading">
                                            <h4 class="panel-title">
                                              <a data-toggle="collapse" data-parent="#accordion" href="#collapseohdsi" style="color:#5A738E;">Choose which of the OHDSI views information you want to include</a>
                                            </h4>
                                          </div>
                                          <div id="collapseohdsi" class="panel-collapse collapse in">
                                              <br></br>
                                              <table class="table table-striped table-bordered" style="width:500px">
                                                <tr>
                                                <td><input type="checkbox"  onclick="enablebutton()" value="yes" id="check">  &nbsp Incidence Rate</td>
                                                <td><input type="checkbox" onclick="enablebutton()" value="yes">&nbsp Notes</td>
                                                </tr>
                                                <tr>
                                                <td><input type="checkbox" name="checkenable"onclick="enablebutton()" value="yes">&nbsp Cohort Characterization</td>
                                                <td><input type="checkbox"  value="yes" onclick="enablebutton()">&nbsp Notes</td>
                                                </tr>
                                                  <tr>
                                                <td><input type="checkbox"  value="yes" onclick="enablebutton()">&nbsp Cohort Pathways</td>
                                                <td><input type="checkbox"  value="yes" onclick="enablebutton()">&nbsp Notes</td>
                                                </tr>
                                                  <tr>
                                                <td><input type="checkbox"  value="yes" onclick="enablebutton()">&nbsp Condition Occurence</td>
                                                <td><input type="checkbox"  value="yes" onclick="enablebutton()">&nbsp Notes</td>
                                                </tr>
                                                    <tr>
                                                <td><input type="checkbox"  value="yes" onclick="enablebutton()">&nbsp Drug Exposure</td>
                                                <td><input type="checkbox"  value="yes" onclick="enablebutton()">&nbsp Notes</td>
                                                </tr>

                                                </table>
                                              <br></br>
                                          </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div id="OpenFDA" class="container tab-pane fade"><br>
                                <input type="checkbox" id="openfda" name="openfda" value="yes">
                              <label for="openfda"> Add every information that I had from OpenFDA</label>
                                <br></br>
                                <div class="container">
                                    <div class="panel-group" id="ombsAccordion">

                                        {% for d,c in scenario.all_combs %}

                                <div id="{{ d }}{% if d and c %} - {% endif %}{{ c }}" class="panel panel-default">
                                    <div class="panel-heading">

                                      <h4 class="panel-title">
                                        <a data-toggle="collapse" data-parent="#combsAccordion" href="#collapse{{ forloop.counter }}" style="color:#5A738E;">{{ d }}{% if d and c %} - {% endif %}{{ c }}</a>
                                      </h4>
                                    </div>
                                    <div id="collapse{{ forloop.counter }}" class="panel-collapse collapse {% if forloop.counter == 1 %}in{% endif %}">
                                      <div class="panel-body">

                                          <table>

                                              <tr><th><input type="checkbox"  value="yes">&nbsp Quick View &nbsp</th><th><button class="btn btn-secondary" data-toggle="modal" data-target="#OpenModal"><i class="fas fa-folder-open"></i></button></th> </tr>
                                          </table>
                                          <br>
                                          <table>
                                            <tr>
                                            <th><input type="checkbox"  value="yes">&nbsp Dynamic PRR</th>
                                            </tr>
                                            <tr>
                                            <td>&nbsp &nbsp &nbsp<input type="checkbox"  value="yes">&nbsp PRR over time &nbsp &nbsp</td>
                                            <td><input type="checkbox"  value="yes">&nbsp Report counts and PRR &nbsp &nbsp</td>
                                            <td><input type="checkbox"  value="yes">&nbspDrugs in scenario reports &nbsp &nbsp</td>
                                                <td><input type="checkbox"  value="yes">&nbspEvents in scenario reports &nbsp &nbsp</td>
                                            </tr>
                                          </table>
                                          <br>
                                          <table>
                                            <tr>
                                            <th><input type="checkbox"  value="yes">&nbsp Change Points Analysis</th>
                                            </tr>
                                            <tr>
                                            <td>&nbsp &nbsp &nbsp<input type="checkbox"  value="yes">&nbsp Change in mean analysis &nbsp &nbsp</td>
                                            <td><input type="checkbox"  value="yes">&nbsp Change in variance analysis &nbsp &nbsp</td>
                                            <td><input type="checkbox"  value="yes">&nbsp Bayesian changepoint analysis  &nbsp &nbsp</td>
                                                <td><input type="checkbox"  value="yes">&nbsp Report counts by date &nbsp &nbsp</td>
                                                <td><input type="checkbox"  value="yes">&nbsp Drug in scenario reports  &nbsp &nbsp</td>
                                                <td><input type="checkbox"  value="yes">&nbsp Events in scenario reports &nbsp &nbsp</td>
                                            </tr>
                                          </table>
                                          <br>
                                          <table>
                                              <tr><th><input type="checkbox"  value="yes">&nbsp Report View</th></tr>
                                          </table>
                                          <br>
                                          <table>
                                              <tr><th><input type="checkbox"  value="yes">&nbsp Notes</th></tr>
                                          </table>


                                        </div>
                                    </div>

                                </div>
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                            <div id="PubMed" class="container tab-pane fade"><br>
                                <input type="checkbox" id="pubmed" name="pubmed" value="yes">
                              <label for="pubmed"> Add every information that I had from PubMed</label>
                                <br></br>
                                <div class="container">
                                    <div class="panel-group" id="accordionpub">
                                        <div class="panel panel-default">
                                          <div class="panel-heading">
                                            <h4 class="panel-title">
                                              <a data-toggle="collapse" data-parent="#accordion" href="#collapsepub" style="color:#5A738E;">Choose which of the PubMed views information you want to include</a>
                                            </h4>
                                          </div>
                                          <div id="collapsepub" class="panel-collapse collapse in">
                                              <br></br>
                                              <table class="table table-striped table-bordered" style="width:800px">
                                                <tr>
                                                <td><input type="checkbox"  value="yes">  &nbsp  Different elemental infant formulas show equivalent phosphorus and calcium bioavailability in healthy volunteers.</td>
                                                <td><input type="checkbox"  value="yes">&nbsp Notes</td>
                                                </tr>
                                                <tr>
                                                <td><input type="checkbox"  value="yes">&nbsp  Low-dose PPI to prevent bleeding after ESD: A multicenter randomized controlled study.</td>
                                                <td><input type="checkbox"  value="yes">&nbsp Notes</td>
                                                </tr>

                                                </table>
                                              <br></br>
                                          </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                            </div>
                            </div>
                            </div>
                </div>
            </div>
        </div>
            <button type="button" class="btn btn-primary active" name="checkenable" id="result1" onclick="openwindow()" disabled><i class="fas fa-spinner"></i> &nbsp Proseed to step 2 to see the review's status until now</button>
<!-- Modal -->
<div class="modal fade" id="OpenModal" tabindex="-1" role="dialog" aria-labelledby="OpenModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
           <button type="button" class="close col-xs-12" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            </div>
      <div class="modal-body">
          <iframe src="http://127.0.0.1:8000/OpenFDAWorkspace/{{scenario_open}}" width="100%" height="550" frameborder="0" allowtransparency="true"></iframe>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
<!--        <button type="button" class="btn btn-primary">Save changes</button>-->
      </div>
    </div>
    <!-- /.modal-content -->
  </div>
  <!-- /.modal-dialog -->
</div>
<!-- /.modal -->

</div>
</div>

{% endblock content %}

{% block javascripts %}

{{ block.super }}

    <script>
function openwindow() {
  var myWindow = window.open("", "myWin");
  myWindow.document.write("<p>This is 'pdf'");

}
</script>

<script>
	$(document).ready(function(){
	var i=0;
        $('input[type="checkbox"]').click(function(){
            if($(this).prop("checked") == true){
                i=i+1
                document.getElementById("result1").disabled = false;
            }
            else if($(this).prop("checked") == false){
                i=i-1
                if(i==0){

                document.getElementById("result1").disabled = true;
            }
            }
        });
    });
</script>

<script>
	$(document).ready(function(){
	var i=0;
        $('input[type="checkbox"]').click(function(){
            if($(this).prop("checked") == true){
                i=i+1
                document.getElementById("result").disabled = false;
            }
            else if($(this).prop("checked") == false){
                i=i-1
                if(i==0){

                document.getElementById("result").disabled = true;
            }
            }
        });
    });
</script>

{% endblock javascripts%}