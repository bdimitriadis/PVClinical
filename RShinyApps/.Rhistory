"$gte": "',paste0(startdate, "T00:00:00.000+00:00"),'",
"$lte": "',paste0(enddate, "T00:00:00.000+00:00"),'"
}
}
]
},
{ "$unwind":
{"path": "$drug"}
},
{ "$unwind":
{"path": "$drug"}
},
{ "$group":{
"_id": {
"$toUpper": "$drug"
},
"count": {
"$sum": 1
}
}
},
{"$sort":
{
"count": -1
}
}
]')
}
x <- createConDrugQuery('L01CA04', '2018-01-01', '2018-03-30')
t <- con$aggregate(x)
createConDrugQuery<-function(drugName, startdate, enddate){
paste0('[{ "$match" : {
"$and":[
{
{ "drugreaction": {
"$not" : { "$size" : 0 }
},
"drugreaction": {
"$eq" : "',paste0('1_',drugName),'"
}
}
},
{
"receiptdate": {
"$gte": "',paste0(startdate, "T00:00:00.000+00:00"),'",
"$lte": "',paste0(enddate, "T00:00:00.000+00:00"),'"
}
}
]
}
},
{ "$unwind":
{"path": "$drug"}
},
{ "$unwind":
{"path": "$drug"}
},
{ "$group":{
"_id": {
"$toUpper": "$drug"
},
"count": {
"$sum": 1
}
}
},
{"$sort":
{
"count": -1
}
}
]')
}
x <- createConDrugQuery('L01CA04', '2018-01-01', '2018-03-30')
t <- con$aggregate(x)
createConDrugQuery<-function(drugName, startdate, enddate){
paste0('[{ "$match" : {
"$and":[
{ "drugreaction": {
"$not" : { "$size" : 0 }
},
"drugreaction": {
"$eq" : "',paste0('1_',drugName),'"
}
},
{
"receiptdate": {
"$gte": "',paste0(startdate, "T00:00:00.000+00:00"),'",
"$lte": "',paste0(enddate, "T00:00:00.000+00:00"),'"
}
}
]
}
},
{ "$unwind":
{"path": "$drug"}
},
{ "$unwind":
{"path": "$drug"}
},
{ "$group":{
"_id": {
"$toUpper": "$drug"
},
"count": {
"$sum": 1
}
}
},
{"$sort":
{
"count": -1
}
}
]')
}
x <- createConDrugQuery('L01CA04', '2018-01-01', '2018-03-30')
t <- con$aggregate(x)
createConEventQuery<-function(eventName){
paste0('[{ "$match" : {
"$and":[
{ "drugreaction": {
"$not" : { "$size" : 0 }
},
"drugreaction": {
"$eq" : "',eventName,'"
}
},
{
"receiptdate": {
"$gte": "',paste0(startdate, "T00:00:00.000+00:00"),'",
"$lte": "',paste0(enddate, "T00:00:00.000+00:00"),'"
}
}
]
}
},
{ "$unwind":
{"path": "$reaction"}
},
{ "$unwind":
{"path": "$reaction"}
},
{ "$group":{
"_id": {
"$toUpper": "$reaction"
},
"count": {
"$sum": 1
}
}
},
{"$sort":
{
"count": -1
}
}
]')
}
x <- createConEventQuery('10051398', '2018-01-01', '2018-03-30')
createConEventQuery<-function(eventName, startdate, enddate){
paste0('[{ "$match" : {
"$and":[
{ "drugreaction": {
"$not" : { "$size" : 0 }
},
"drugreaction": {
"$eq" : "',eventName,'"
}
},
{
"receiptdate": {
"$gte": "',paste0(startdate, "T00:00:00.000+00:00"),'",
"$lte": "',paste0(enddate, "T00:00:00.000+00:00"),'"
}
}
]
}
},
{ "$unwind":
{"path": "$reaction"}
},
{ "$unwind":
{"path": "$reaction"}
},
{ "$group":{
"_id": {
"$toUpper": "$reaction"
},
"count": {
"$sum": 1
}
}
},
{"$sort":
{
"count": -1
}
}
]')
}
x <- createConEventQuery('10051398', '2018-01-01', '2018-03-30')
t <- con$aggregate(x)
TimeseriesForTotalReports<-function(startdate, enddate){
paste0('[
{
"$match": {
"$and":
{
"drugreaction": {
"$not": {
"$size": 0
}
}
},
{
"receiptdate": {
"$gte": "',paste0(startdate, "T00:00:00.000+00:00"),'",
"$lte": "',paste0(enddate, "T00:00:00.000+00:00"),'"
}
}
]
}
}, {
"$group": {
"_id": {
"$toUpper": "$receiptdate"
},
"count": {
"$sum": 1
}
}
}, {
"$sort": {
"_id": 1
}
}
]')}
x <- TimeseriesForTotalReports('2018-01-01', '2018-03-30')
t <- con$aggregate(x)
TimeseriesForTotalReports<-function(startdate, enddate){
paste0('[
{
"$match": {
"$and": [
{
"drugreaction": {
"$not": {
"$size": 0
}
}
},
{
"receiptdate": {
"$gte": "',paste0(startdate, "T00:00:00.000+00:00"),'",
"$lte": "',paste0(enddate, "T00:00:00.000+00:00"),'"
}
}
]
}
}, {
"$group": {
"_id": {
"$toUpper": "$receiptdate"
},
"count": {
"$sum": 1
}
}
}, {
"$sort": {
"_id": 1
}
}
]')}
x <- TimeseriesForTotalReports('2018-01-01', '2018-03-30')
t <- con$aggregate(x)
t
SearchDrugReports<-function(drugName, startdate, enddate){
paste0('[
{
"$match": {
"$and": [
{
"drugreaction": {
"$eq": "',paste0('1_',drugName),'"
}
},
{
"receiptdate": {
"$gte": "',paste0(startdate, "T00:00:00.000+00:00"),'",
"$lte": "',paste0(enddate, "T00:00:00.000+00:00"),'"
}
}
]
}
}, {
"$project": {
"safetyreportid": 1,
"_id": 0
}
}
]')}
x <- SearchDrugReports('L01CA04', '2018-01-01', '2018-03-30')
t <- con$aggregate(x)
t
SearchEventReports<-function(eventName, startdate, enddate){
paste0('[
{
"$match": {
"$and":[
{
"drugreaction": {
"$eq": "',eventName,'"
}
},
{
"receiptdate": {
"$gte": "',paste0(startdate, "T00:00:00.000+00:00"),'",
"$lte": "',paste0(enddate, "T00:00:00.000+00:00"),'"
}
}
]
}
}, {
"$project": {
"safetyreportid": 1,
"_id": 0
}
}
]')}
x <- SearchEventReports('10051398', '2018-01-01', '2018-03-30')
t <- con$aggregate(x)
t
SearchDrugEventReports<-function(drugName, eventName, startdate, enddate){
paste0('[
{
"$match": {
"$and": [
{
"$and": [
{
"drugreaction": {
"$eq": "',paste0('1_',drugName),'"
}
}, {
"drugreaction": {
"$eq": "',eventName,'"
}
}
]
},
{
"receiptdate": {
"$gte": "',paste0(startdate, "T00:00:00.000+00:00"),'",
"$lte": "',paste0(enddate, "T00:00:00.000+00:00"),'"
}
}
]
}
}, {
"$project": {
"safetyreportid": 1,
"_id": 0
}
}
]')}
x <- SearchEventReports('L01CA04','10051398', '2018-01-01', '2018-03-30')
x <- SearchDrugEventReports('L01CA04','10051398', '2018-01-01', '2018-03-30')
t <- con$aggregate(x)
t
shiny::runApp('ChangePoint')
runApp('ChangePoint')
shiny::runApp('LrTest')
runApp('LrTest')
runApp('LrTest')
runApp('LrTest')
runApp('LrTest')
runApp('LrTest')
drugResult
runApp('LrTest')
runApp('LrTest')
runApp('LrTest')
runApp('LrTest')
runApp('LrTest')
runApp('LrTest')
runApp('LrTest')
runApp('LrTest')
input$date1
totalreports(startdate = input$date1, enddate = input$date2)
totalResult <- con$aggregate(totalQuery)
totalQuery<-totalreports(startdate = input$date1, enddate = input$date2)
totalResult <- con$aggregate(totalQuery)
otal<-totalResult$safetyreportid
runApp('LrTest')
runApp('LrTest')
runApp('LrTest')
myurl
runApp('LrTest')
runApp('LrTest')
shiny::runApp('Dash')
runApp('Dash')
shiny::runApp('DynPRR')
runApp('DynPRR')
runApp('DynPRR')
runApp('RR_D')
# browser()
q$concomitant <- TRUE
runApp('RR_D')
shiny::runApp('RR_D')
shiny::runApp('ChangePoint')
runApp('RR_E')
runApp('RR_E')
# q<-NULL
# q$v1<-"patient.drug.openfda.generic_name"
# q$v1<-"patient.reaction.reactionmeddrapt"
# q$t1<-"D10AD04"
# q$t1<-"10003239"
# q$hash <- "asjhakh"
# browser()
# q$concomitant <- TRUE
updateNumericInput(session, "limit", value = q$limit)
runApp('RR_E')
runApp('C:/Users/sdimitsaki/Desktop/PVClinical/pvclinical-dashboard/RShinyApps/QuickViewDrugEvent')
runApp('QuickViewDrugEvent')
result
query
runApp('QuickViewDrugEvent')
result
query
result
result
shiny::runApp('LrTest')
runApp('LrTest')
runApp('LrTest')
runApp('LrTest')
runApp('LrTest')
runApp('LrTest')
runApp('LrTest')
shiny::runApp('LrTest')
runApp('LrTest')
runApp('LrTest')
# q$v2<-"patient.reaction.reactionmeddrapt"
# q$t1<-"Omeprazole"
# q$drug<-toupper(q$t1)
# q$t2<-"Anaemia"
# q$v1<-"patient.drug.openfda.generic_name"
# q$v1<-"patient.reaction.reactionmeddrapt"
q$t1<-"L01CA04"
runApp('LrTest')
View(comb)
input$date2-input$date1
input$date2-input$date1
mycritval <- getCritVal2(session, numsims, comb$n.j[1], comb$ni., comb$n..[1], comb$pi., .95)
runApp('C:/Users/sdimitsaki/Desktop/PVClinical/pvclinical-dashboard/RShinyApps/LrTest_E')
runApp('LrTest_E')
runApp('LrTest_E')
runApp('LrTest_E')
runApp('LrTest_E')
totalEventInReports(input$date1, input$date2)
runApp('LrTest_E')
shiny::runApp('QuickViewDrugEvent')
runApp('QuickViewDrugEvent')
runApp('QuickViewDrugEvent')
View(mydf)
runApp('QuickViewDrugEvent')
runApp('QuickViewDrugEvent')
t[2]
View(mylist)
runApp('QuickViewDrugEvent')
q$t2
q$ename
runApp('QuickViewDrugEvent')
eventName
X <- NULL
toupper(X)
identical(toupper(X), character(0))
runApp('QuickViewDrugEvent')
runApp('QuickViewDrugEvent')
identical(eventName, character(0))
!is.null(eventName)
runApp('QuickViewDrugEvent')
runApp('QuickViewDrugEvent')
q$ename
runApp('QuickViewDrugEvent')
q
myurl
input$v1
runApp('QuickViewDrugEvent')
myurl
runApp('QuickViewDrugEvent')
eventvar
myv
myt
cururl
myv[2] <- "patient.drug.openfda.generic_name.exact"
cururl <- buildURL(v= myv, t=myt, limit=1, whichkey=i%%2)
cururl
runApp('QuickViewDrugEvent')
shiny::runApp('RR_E')
shiny::runApp('RR_E')
runApp()
runApp('RR_E')
shiny::runApp('RR_E')
runApp('RR_E')
runApp('RR_E')
shiny::runApp('QuickViewDrugEvent')
runApp('RR_E')
runApp('RR_E')
shiny::runApp('RR_E')
runApp('RR_E')
shiny::runApp('QuickViewDrugEvent')
